##### LIST ALL SAMPLES #####
OUTFILE = 'meth_VDUse.txt'
setwd('/home/jcastle/VitaminUse_Study/data')
DATADIR <- "/mnt/DATA/meqtl/seq/"

samples_with_geno <- c(
  '1546-01A_GB1',    '1546-01B_GB7',    '1546-01C_GB14',   '1546-01D_GB20',
  '1546-01E_GB26',   '1546-01F_GB32',   '1546-01G_GB39',   '1546-01H_GB45', 
  '1546-02A_GC1',    '1546-02C_GC14',   '1546-03B_GB8',    '1546-03C_GB15', 
  '1546-03D_GB21',   '1546-03E_GB27',   '1546-03G_GB40',   '1546-03H_GB46', 
  '1546-04A_GC2',    '1546-04E_GC27',   '1546-04F_GC33',   '1546-04G_GC40', 
  '1546-05A_GB3',    '1546-05C_GB16',   '1546-05D_GB22',   '1546-05E_GB28', 
  '1546-05F_GB34',   '1546-05G_GB41',   '1546-05H_GB47',   '1546-06B_GC9', 
  '1546-06D_GC22',   '1546-06H_GC47',   '1546-07A_GB4',    '1546-07B_GB10', 
  '1546-07C_GB17',   '1546-07F_GB35',   '1546-07G_GB42',   '1546-08B_GC10', 
  '1546-08D_GC23',   '1546-08E_GC29',   '1546-08F_GC35',   '1546-09A_GB5', 
  '1546-09C_GB18',   '1546-09E_GB30',   '1546-09F_GB37',   '1546-09H_GB49', 
  '1546-10C_GC18',   '1546-10E_GC30',   '1546-10F_GC37',   '1546-11B_GB12', 
  '1546-11E_GB31',   '1546-11F_GB38',   '1546-11G_GB44',   '1546-12B_GC12', 
  '1546-12D_GC25',   '1546-12F_GC38',   '1547-01B_GB58',   '1547-01H_GB96', 
  '1547-02B_GC58',   '1547-02D_GC70',   '1547-02E_GC76',   '1547-02F_GC82', 
  '1547-02H_GC96',   '1547-03B_GB59',   '1547-03C_GB65',   '1547-03D_GB71', 
  '1547-03E_GB77',   '1547-03F_GB84',   '1547-03G_GB91',   '1547-04G_GC91', 
  '1547-04H_GC97',   '1547-05B_GB60',   '1547-05C_GB67',   '1547-05E_GB78', 
  '1547-05F_GB85',   '1547-05G_GB92',   '1547-06D_GC72',   '1547-06G_GC92', 
  '1547-06H_GC98',   '1547-07E_GB79',   '1547-08E_GC79',   '1547-08G_GC93', 
  '1547-09A_GB56',   '1547-09B_GB62',   '1547-09C_GB68',   '1547-09E_GB80', 
  '1547-10A_GC56',   '1547-10C_GC68',   '1547-10E_GC80',   '1547-10F_GC87', 
  '1547-11A_GB57',   '1547-11B_GB63',   '1547-11C_GB69',   '1547-11D_GB75', 
  '1547-11H_GB101',  '1547-12C_GC69',   '1547-12D_GC75',   '1547-12E_GC81', 
  '1547-12G_GC95',   '1547-12H_GC101',  '1548-01A_GB102',  '1548-01B_GB108', 
  '1548-01C_GB115',  '1548-02A_GC102',  '1548-02B_GC108',  '1548-02C_GC115', 
  '1548-02F_GC135',  '1548-02G_GC142',  '1548-02H_GC148',  '1548-03A_GB103', 
  '1548-03B_GB109',  '1548-03C_GB116',  '1548-03D_GB123',  '1548-04C_GC116', 
  '1548-04E_GC129',  '1548-04F_GC136',  '1548-04G_GC143',  '1548-05A_GB104', 
  '1548-05B_GB110',  '1548-06A_GC104',  '1548-06B_GC110',  '1548-06D_GC124', 
  '1548-06G_GC144',  '1548-06H_GC151',  '1548-07B_GB111',  '1548-07D_GB125', 
  '1548-08D_GC125',  '1548-08E_GC131',  '1548-09A_GB106',  '1548-09B_GB112', 
  '1548-10C_GC120',  '1548-11A_GB107',  '1548-11B_GB113',  '1548-12B_GC113', 
  '1548-12D_GC127',  '1548-12G_GC147',  '1549-02D_GC173',  '1549-02F_GC188', 
  '1549-02G_GC194',  '1549-04A_GC156',  '1549-04C_GC168',  '1549-04D_GC174', 
  '1549-04F_GC189',  '1549-04H_GC203',  '1549-06F_GC190',  '1549-08B_GC164', 
  '1549-08C_GC170',  '1549-08D_GC178',  '1549-08F_GC191',  '1549-08H_GC205', 
  '1549-10A_GC159',  '1549-10B_GC165',  '1549-10C_GC171',  '1549-10D_GC179', 
  '1549-10G_GC199',  '1549-12D_GC181',  '1549-12E_GC187',  '1549-12F_GC193', 
  '1549-12G_GC200',  '1549-12H_GC207',  '1550-02A_GC208',  '1550-02C_GC225', 
  '1550-02E_GC238',  '1550-02G_GC250',  '1550-02H_GC257',  '1550-04B_GC218', 
  '1550-04C_GC226',  '1550-04D_GC233',  '1550-04H_GC259',  '1550-06A_GC210', 
  '1550-06B_GC220',  '1550-06C_GC228',  '1550-06E_GC240',  '1550-06H_GC260', 
  '1550-08C_GC229',  '1550-08D_GC235',  '1550-08G_GC253',  '1550-10A_GC213', 
  '1550-10B_GC222',  '1550-10C_GC230',  '1550-10D_GC236',  '1550-10E_GC242', 
  '1550-12C_GC231',  '1550-12D_GC237',  '1550-12F_GC249',  '1550-12G_GC256', 
  '1550-12H_GC265',  '1551-01F_GB344',  '1551-01G_GB500',  '1551-02A_GC266', 
  '1551-02B_GC274',  '1551-02C_GC283',  '1551-02D_GC291',  '1551-02E_GC337', 
  '1551-02F_GC344',  '1551-02G_GC500',  '1551-03H_GB507',  '1551-04D_GC293', 
  '1551-05F_GB347',  '1551-05H_GB508',  '1551-06B_GC277',  '1551-06C_GC285', 
  '1551-06F_GC347',  '1551-06H_GC508',  '1551-07F_GB348',  '1551-07G_GB503', 
  '1551-07H_GB509',  '1551-08F_GC348',  '1551-08G_GC503',  '1551-08H_GC509', 
  '1551-09F_GB349',  '1551-10A_GC272',  '1551-10F_GC349',  '1551-10G_GC504', 
  '1551-11G_GB505',  '1551-11H_GB511',  '1552-01A_GB512',  '1552-01C_GB700', 
  '1552-04A_GC514',  '1552-05A_GB515',  '1552-06A_GC515',  '1552-08A_GC516', 
  '1552-08B_GC522',  '1552-10A_GC517'
);

samples_with_VDUse <- c(
  '1546-02A_GC1', '1550-04D_GC233', '1551-03H_GB507', '1547-02E_GC76', '1551-05H_GB508',
  '1549-10D_GC179', '1550-12F_GC249', '1551-11G_GB505', '1547-08E_GC79', '1549-04G_GC195',
  '1547-06G_GC92', '1547-06D_GC72', '1551-05G_GB502', '1552-04A_GC514', '1551-02D_GC291',
  '1546-12D_GC25', '1547-02F_GC82', '1550-12D_GC237', '1547-12E_GC81', '1549-12G_GC200',
  '1548-04E_GC129', '1548-08D_GC125', '1546-08E_GC29', '1548-06A_GC104', '1546-06D_GC22',
  '1549-12H_GC207', '1550-10B_GC222', '1549-10G_GC199', '1549-12D_GC181', '1547-08G_GC93',
  '1550-02H_GC257', '1546-06H_GC47', '1550-02G_GC250', '1550-04C_GC226', '1546-02D_GC20',
  '1549-08B_GC164', '1549-12F_GC193', '1551-01G_GB500', '1547-10A_GC56', '1551-10A_GC272',
  '1548-12G_GC147', '1551-08H_GC509', '1547-12C_GC69', '1548-06D_GC124', '1550-06E_GC240',
  '1548-10C_GC120', '1546-10F_GC37', '1550-10D_GC236', '1546-04A_GC2', '1547-12G_GC95',
  '1551-12C_GC290', '1550-06A_GC210', '1548-04C_GC116', '1547-12D_GC75', '1551-02E_GC337',
  '1546-12F_GC38', '1551-06F_GC347', '1548-02A_GC102', '1548-06B_GC110', '1551-02A_GC266',
  '1551-02F_GC344', '1551-06C_GC285', '1548-06G_GC144', '1548-04G_GC143', '1549-02D_GC173',
  '1551-11H_GB511', '1547-10C_GC68', '1549-04D_GC174', '1551-03G_GB501', '1550-06B_GC220',
  '1552-05A_GB515', '1546-04G_GC40', '1549-06F_GC190', '1547-10E_GC80', '1549-08H_GC205',
  '1550-08D_GC235', '1546-08G_GC42', '1551-08F_GC348', '1548-08E_GC131', '1546-02C_GC14',
  '1548-02B_GC108', '1546-06B_GC9', '1547-04G_GC91', '1546-04D_GC21', '1550-12H_GC265',
  '1548-02G_GC142', '1550-06H_GC260', '1547-12H_GC101', '1549-04F_GC189', '1548-02H_GC148',
  '1551-10F_GC349', '1552-12A_GC518', '1550-12G_GC256', '1548-04F_GC136', '1552-08B_GC522',
  '1551-06H_GC508', '1547-02B_GC58', '1550-02C_GC225', '1546-12B_GC12', '1550-04B_GC218',
  '1552-08A_GC516', '1546-04E_GC27', '1548-06H_GC151', '1550-02A_GC208', '1550-10C_GC230',
  '1552-10A_GC517', '1548-12B_GC113', '1551-10G_GC504', '1546-08D_GC23', '1547-02H_GC96',
  '1550-12C_GC231', '1551-08G_GC503', '1550-10A_GC213', '1551-06B_GC277', '1549-02G_GC194',
  '1550-10E_GC242', '1549-04C_GC168', '1550-08G_GC253', '1546-10C_GC18', '1551-07H_GB509',
  '1549-08D_GC178', '1550-04H_GC259', '1546-10E_GC30', '1552-01A_GB512', '1549-10B_GC165',
  '1551-02B_GC274', '1551-06G_GC502', '1548-12D_GC127', '1551-02G_GC500', '1549-10C_GC171',
  '1550-08C_GC229', '1549-08C_GC170', '1546-08F_GC35', '1549-12E_GC187', '1552-06A_GC515',
  '1546-04F_GC33', '1546-08B_GC10', '1547-02D_GC70', '1547-10F_GC87', '1549-04A_GC156',
  '1551-02C_GC283', '1549-10A_GC159', '1548-02C_GC115', '1549-02F_GC188', '1549-08F_GC191',
  '1549-04H_GC203', '1547-06H_GC98', '1550-02E_GC238','1551-07G_GB503', '1550-06C_GC228',
  '1548-02F_GC135', '1547-04H_GC97', '1551-04D_GC293'
);

##### CONVERT _inTruseq.csv TO A FORMAT USABLE BY GEM #####
samples <- samples_with_VDUse
filename = paste(DATADIR, samples[1], '_inTruseq.csv', sep = '')
B_seq_all = read.csv(filename, header = T)

for (i in 2:length(samples)){
  filename = paste(DATADIR, samples[i], '_inTruseq.csv', sep = '')
  if( i %% 20 == 0 ){
    print( paste("Merging iteration = ", i, sep = '') )
  }
  tmp = read.csv(filename, header = T)
  B_seq_all = Reduce(
    function(x, y) merge(x, y, by = c('pos'), all=T),
    list(B_seq_all, tmp)
  )
  rm(tmp)
}

write.table(B_seq_all, file = OUTFILE, quote = F, append = FALSE, sep = "\t", row.names=FALSE)
rm(B_seq_all)
rm(samples)